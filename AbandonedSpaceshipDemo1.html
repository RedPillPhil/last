<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0">
		<title>AbandonedSpaceshipDemo1</title>
		<style>
			/* (Your existing CSS goes here) */
		</style>
		<link id="-gd-engine-icon" rel="icon" type="image/png" href="AbandonedSpaceshipDemo1.icon.png" />
		<link rel="apple-touch-icon" href="AbandonedSpaceshipDemo1.apple-touch-icon.png"/>
	</head>
	<body>
		<canvas id="canvas">Your browser does not support the canvas tag.</canvas>
		<noscript>
			Your browser does not support JavaScript.
		</noscript>

		<div id="status">
			<img id="status-splash" class="show-image--true fullsize--true use-filter--true" src="AbandonedSpaceshipDemo1.png" alt="">
			<progress id="status-progress"></progress>
			<div id="status-notice"></div>
		</div>

		<script src="AbandonedSpaceshipDemo1.js"></script>
		<script>
			// Function to download and load the .pck file
			function downloadAndLoadPck() {
				const pckUrl = "https://github.com/RedPillPhil/last/releases/download/game/AbandonedSpaceshipDemo1.pck";
				const httpRequest = new XMLHttpRequest();
				httpRequest.open("GET", pckUrl, true);
				httpRequest.responseType = "arraybuffer";
				
				httpRequest.onload = function () {
					if (httpRequest.status === 200) {
						const pckData = httpRequest.response;
						const file = new File([pckData], "AbandonedSpaceshipDemo1.pck", {type: "application/octet-stream"});
						
						// Save the .pck file to user:// using File API
						const fileReader = new FileReader();
						fileReader.onload = function(event) {
							const buffer = event.target.result;
							// Save to the user directory (not directly available from JavaScript)
							// You may need to use a specific function of the Godot engine to handle this part
							// Save it locally with a specific Godot method (using Engine API)
							// Placeholder for the real saving mechanism (This is pseudo code)
							
							// After saving, load the game with the downloaded .pck
							Engine.load_game("user://AbandonedSpaceshipDemo1.pck");
						};
						fileReader.readAsArrayBuffer(file);
					} else {
						console.error("Failed to download .pck file.");
					}
				};
				
				httpRequest.onerror = function () {
					console.error("An error occurred while downloading the .pck file.");
				};
				
				httpRequest.send();
			}

			// When the page loads, call downloadAndLoadPck()
			downloadAndLoadPck();
		</script>
	</body>
</html>
